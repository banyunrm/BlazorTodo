@page "/todos/delete/{Id:int}"
@using BlazorTodo.WebUI.Data
@using BlazorTodo.WebUI.Models
@inject AppDbContext Db
@inject NavigationManager Nav

<h3>Hapus Todo</h3>

@if (todo == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <div class="alert alert-warning">
        <h4>Apakah yakin ingin menghapus?</h4>
        <p><strong>@todo.Title</strong></p>
        <p>@todo.Description</p>
    </div>

    <button class="btn btn-danger" @onclick="OnDelete">Hapus</button>
    <button class="btn btn-secondary" @onclick="GoBack">Batal</button>
}

@code {
    [Parameter] public int Id { get; set; }
    private Todo? todo;

    protected override void OnInitialized()
    {
        todo = Db.Todos.FirstOrDefault(t => t.Id == Id);
    }

    private void OnDelete()
    {
        if (todo != null)
        {
            Db.Todos.Remove(todo);
            Db.SaveChanges();
            Nav.NavigateTo("/todos");
        }
    }

    private void GoBack()
    {
        Nav.NavigateTo("/todos");
    }
}
