@page "/countries/delete/{Id:int}"

<h3>Delete Country</h3>

@if (country == null)
{
    <MudProgressCircular Indeterminate="true" Color="Color.Primary" />
}
else
{
    <MudAlert Severity="Severity.Warning" Variant="Variant.Filled" Class="mb-3">
        Are you sure you want to delete this country?
        <br /><strong>@country.Name</strong> (Code: @country.Code)
    </MudAlert>

    <MudButton Color="Color.Error" Variant="Variant.Filled" OnClick="DeleteCountry" Class="me-2">Delete</MudButton>
    <MudButton Color="Color.Secondary" Variant="Variant.Outlined" OnClick="Cancel">Cancel</MudButton>
}

@code {
    [Parameter] public int Id { get; set; }
    private Country? country;

    protected override async Task OnInitializedAsync()
    {
        country = await Database.Countries.FindAsync(Id);
    }

    private async Task DeleteCountry()
    {
        if (country != null)
        {
            Database.Countries.Remove(country);
            await Database.SaveChangesAsync();
        }
        Nav.NavigateTo("/countries");
    }

    private void Cancel() => Nav.NavigateTo("/countries");
}
